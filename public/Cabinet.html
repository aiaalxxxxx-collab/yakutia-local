<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ö–∞–±–∏–Ω–µ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f2f4f7;
      color: #111;
    }
    a { color: inherit; text-decoration: none; }

    :root {
      --accent: #00a86b;
      --accent-dark: #008055;
    }

    header {
      background: var(--accent);
      color: #fff;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 16px;
    }
    .header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 0;
    }
    .logo {
      font-weight: 700;
      font-size: 18px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .back-link {
      font-size: 13px;
    }

    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px;
    }

    .lk-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }
    .lk-tab {
      padding: 6px 10px;
      font-size: 14px;
      border-radius: 999px;
      border: 1px solid transparent;
      cursor: pointer;
      background: #e4e7ec;
    }
    .lk-tab.active {
      background: var(--accent);
      border-color: var(--accent);
      color: #fff;
    }

    .section-title {
      font-size: 18px;
      margin: 0 0 10px;
    }

    .lk-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.2fr);
      gap: 16px;
      align-items: flex-start;
    }

    .box {
      background: #ffffff;
      border-radius: 12px;
      border: 1px solid #e0e0e0;
      padding: 12px;
      font-size: 13px;
    }
    .box h2 {
      margin: 0 0 8px;
      font-size: 16px;
    }

    .form-row {
      display: flex;
      flex-direction: column;
      margin-bottom: 8px;
      gap: 3px;
    }
    label {
      font-size: 12px;
      color: #555;
    }
    input,
    textarea,
    select {
      font: inherit;
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #d0d0d0;
      background: #fafafa;
    }
    textarea {
      resize: vertical;
      min-height: 48px;
    }

    .btn {
      display: inline-block;
      padding: 8px 14px;
      border-radius: 999px;
      border: none;
      background: var(--accent);
      color: #fff;
      font-size: 13px;
      cursor: pointer;
      margin-top: 4px;
      width: 100%;
    }

    .hint {
      font-size: 11px;
      color: #777;
      margin-top: 4px;
    }

    .grid-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
      gap: 10px;
    }
    .card {
      background: #ffffff;
      border-radius: 10px;
      border: 1px solid #e0e0e0;
      padding: 8px;
      font-size: 13px;
    }
    .card-title {
      font-weight: 500;
      margin-bottom: 4px;
    }
    .card-price {
      font-weight: 600;
      margin-bottom: 2px;
    }
    .card-meta {
      font-size: 11px;
      color: #777;
    }

    @media (max-width: 800px) {
      .lk-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
</head>
<body>
<header>
  <div class="container header-top">
    <div class="logo">YAKUTIA LOCAL</div>
    <div class="back-link"><a href="index.html" style="color:#fff;">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a></div>
  </div>
</header>

<main>
  <div class="lk-tabs">
    <div class="lk-tab active" data-tab="profile">–ü—Ä–æ—Ñ–∏–ª—å</div>
    <div class="lk-tab" data-tab="my-ads">–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</div>
  </div>

  <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
  <section id="profile-section">
    <h1 class="section-title">–ü—Ä–æ—Ñ–∏–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞</h1>
    <div class="lk-grid">
      <div class="box">
        <h2>–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</h2>

        <div class="form-row">
          <label>–ò–º—è</label>
          <input placeholder="–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è" />
        </div>
        <div class="form-row">
          <label>–ì–æ—Ä–æ–¥ / –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã–π –ø—É–Ω–∫—Ç</label>
          <input placeholder="–Ø–∫—É—Ç—Å–∫, –ù–µ—Ä—é–Ω–≥—Ä–∏, —Å–µ–ª–æ..." />
        </div>
        <div class="form-row">
          <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
          <input placeholder="+7 999 000‚Äë00‚Äë00" />
        </div>
        <div class="form-row">
          <label>Email</label>
          <input placeholder="you@example.com" />
        </div>
        <div class="form-row">
          <label>–û —Å–µ–±–µ –∏ –±—Ä–µ–Ω–¥–µ</label>
          <textarea placeholder="–ö–æ—Ä–æ—Ç–∫–æ —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ, —á–µ–º –≤—ã –∑–∞–Ω–∏–º–∞–µ—Ç–µ—Å—å, –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ."></textarea>
        </div>
        <button class="btn" type="button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å (–º–∞–∫–µ—Ç)</button>
        <p class="hint">–í –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä.</p>
      </div>

      <div class="box">
        <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–º–∞–∫–µ—Ç)</h2>
        <p>–ó–∞–∫–∞–∑—ã: <strong>0</strong></p>
        <p>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π: <span id="ads-count">0</span></p>
        <p>–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º —É –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π: <strong>0</strong></p>
        <p class="hint">–í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –∂–∏–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –≤–∞—à–∏–º —Ç–æ–≤–∞—Ä–∞–º –∏ –∑–∞–∫–∞–∑–∞–º.</p>
      </div>
    </div>
  </section>

  <!-- –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
  <section id="my-ads-section" style="display:none;">
    <h1 class="section-title">–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h1>
    <div class="lk-grid">
      <div class="box">
        <h2>–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h2>

        <div class="form-row">
          <label for="a-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
          <input id="a-title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–¥–∞–º —à–∫—É—Ä—ã –æ–ª–µ–Ω—è" />
        </div>

        <div class="form-row">
          <label for="a-price">–¶–µ–Ω–∞, ‚ÇΩ</label>
          <input id="a-price" type="number" min="1" placeholder="3500" />
        </div>

        <div class="form-row">
          <label for="a-oldprice">–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞, ‚ÇΩ (–µ—Å–ª–∏ –µ—Å—Ç—å)</label>
          <input id="a-oldprice" type="number" min="1" placeholder="4200" />
        </div>

        <div class="form-row">
          <label for="a-type">–ì–¥–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å</label>
          <select id="a-type">
            <option value="market">–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å (—Ç–æ–≤–∞—Ä—ã)</option>
            <option value="ads">–û–±—ä—è–≤–ª–µ–Ω–∏–µ (—É—Å–ª—É–≥–∏/–∞—Ä–µ–Ω–¥–∞ –∏ —Ç.–ø.)</option>
          </select>
        </div>

        <div class="form-row">
          <label for="a-category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
          <select id="a-category">
            <option value="food">ü•©üçØ –ü—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</option>
            <option value="clothes">üß•üß§ –û–¥–µ–∂–¥–∞, –æ–±—É–≤—å –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
            <option value="souvenirs">üéÅ –°—É–≤–µ–Ω–∏—Ä—ã, —É–∫—Ä–∞—à–µ–Ω–∏—è, –∏–Ω—Ç–µ—Ä—å–µ—Ä</option>
            <option value="cosmetics">üß¥ –ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ –ë–ê–î—ã</option>
            <option value="industrial">üß± –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</option>
          </select>
        </div>

        <div class="form-row">
          <label for="a-season">–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å (–¥–ª—è –≤–∏—Ç—Ä–∏–Ω—ã)</label>
          <select id="a-season">
            <option value="">–ù–µ —É–∫–∞–∑–∞–Ω–æ</option>
            <option value="winter">–ó–∏–º–∞</option>
            <option value="spring">–í–µ—Å–Ω–∞</option>
            <option value="summer">–õ–µ—Ç–æ</option>
            <option value="autumn">–û—Å–µ–Ω—å</option>
          </select>
        </div>

        <div class="form-row">
          <label for="a-desc">–û–ø–∏—Å–∞–Ω–∏–µ</label>
          <textarea id="a-desc" placeholder="–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ —Ç–æ–≤–∞—Ä: –º–∞—Ç–µ—Ä–∏–∞–ª—ã, —Ä–∞–∑–º–µ—Ä—ã, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, —É—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏."></textarea>
        </div>

        <div class="form-row">
          <label for="a-place">–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ–≤–∞—Ä</label>
          <input id="a-place" placeholder="–Ø–∫—É—Ç—Å–∫, —á–∞—Å—Ç–Ω–æ–µ –ª–∏—Ü–æ / –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è" />
        </div>

        <div class="form-row">
          <label>
            <input type="checkbox" id="a-promoted" />
            –í—ã–¥–µ–ª–∏—Ç—å –∫–∞–∫ ¬´–¢–û–ü¬ª (–º–∞–∫–µ—Ç, –ø–æ–∫–∞ –±–µ–∑ –æ–ø–ª–∞—Ç—ã)
          </label>
        </div>

        <div class="form-row">
          <label>
            <input type="checkbox" id="a-sale" />
            –¢–æ–≤–∞—Ä –ø–æ –∞–∫—Ü–∏–∏ (–±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–∞ —Å–∫–∏–¥–∫–∞)
          </label>
        </div>

        <button class="btn" type="button" onclick="addMyAd()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</button>
        <p class="hint">–í –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ products.json –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.</p>
      </div>

      <div class="box">
        <h2>–í–∞—à–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
        <div class="grid-cards" id="my-ads-list"></div>
      </div>
    </div>
  </section>
</main>

<script>
  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
  const lkTabs = document.querySelectorAll('.lk-tab');
  const profileSection = document.getElementById('profile-section');
  const adsSection = document.getElementById('my-ads-section');

  lkTabs.forEach(tab => {
    tab.addEventListener('click', () => {
      lkTabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');

      const t = tab.dataset.tab;
      if (t === 'profile') {
        profileSection.style.display = '';
        adsSection.style.display = 'none';
      } else {
        profileSection.style.display = 'none';
        adsSection.style.display = '';
      }
    });
  });

  // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤—Å–µ—Ö –∏–∑ products.json)
  async function loadMyAds() {
    try {
      const res = await fetch('/api/products');
      const products = await res.json();
      const list = document.getElementById('my-ads-list');
      list.innerHTML = '';

      products.forEach(p => {
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <div class="card-title">${p.title}</div>
          <div class="card-price">${p.price} ‚ÇΩ</div>
          <div class="card-meta">
            ${p.type === 'market' ? '–¢–æ–≤–∞—Ä –Ω–∞ –≤–∏—Ç—Ä–∏–Ω–µ' : '–û–±—ä—è–≤–ª–µ–Ω–∏–µ'} ‚Ä¢
            ${p.place || '–Ø–∫—É—Ç–∏—è'}<br>
            –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${p.category || '–Ω–µ —É–∫–∞–∑–∞–Ω–∞'}
          </div>
        `;
        list.appendChild(card);
      });

      const countEl = document.getElementById('ads-count');
      if (countEl) countEl.textContent = products.length;
    } catch (e) {
      console.error(e);
    }
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
  async function addMyAd() {
    const title = document.getElementById('a-title').value.trim();
    const price = document.getElementById('a-price').value.trim();
    const oldPrice = document.getElementById('a-oldprice').value.trim();
    const type = document.getElementById('a-type').value;
    const season = document.getElementById('a-season').value;
    const desc = document.getElementById('a-desc').value.trim();
    const place = document.getElementById('a-place').value.trim();
    const promoted = document.getElementById('a-promoted').checked;
    const isSale = document.getElementById('a-sale').checked;
    const category = document.getElementById('a-category').value;

    if (!title || !price) {
      alert('–£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É');
      return;
    }

    let discount = null;
    if (oldPrice) {
      discount = Math.round((1 - Number(price) / Number(oldPrice)) * 100);
    }

    try {
      const res = await fetch('/api/products', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          title,
          price,
          oldPrice: oldPrice || null,
          discount,
          type,
          desc,
          place,
          promoted,
          isSale,
          season,
          category,
          popularity: 0
        })
      });

      if (!res.ok) {
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è');
        return;
      }

      await loadMyAds();

      document.getElementById('a-title').value = '';
      document.getElementById('a-price').value = '';
      document.getElementById('a-oldprice').value = '';
      document.getElementById('a-desc').value = '';
      document.getElementById('a-place').value = '';
      document.getElementById('a-promoted').checked = false;
      document.getElementById('a-sale').checked = false;
      document.getElementById('a-season').value = '';
      document.getElementById('a-category').value = 'food';
    } catch (e) {
      console.error(e);
      alert('–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');
    }
  }

  document.addEventListener('DOMContentLoaded', loadMyAds);
</script>
</body>
</html>
