<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#f8fdff">
    <title>Yakutia Market</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />
    
    <style>
        /* --- GOOGLE MATERIAL 3 THEME --- */
        :root {
            --primary: #00639b;
            --on-primary: #ffffff;
            --container: #cce5ff;
            --bg: #f8fdff;
            --surface: #ffffff;
            --text: #191c1e;
            --outline: #72777f;
            --anim: 0.3s cubic-bezier(0.2, 0, 0, 1);
        }

        body {
            margin: 0; padding: 0;
            background: var(--bg); color: var(--text);
            font-family: 'Roboto', sans-serif;
            padding-bottom: 100px; /* –ú–µ—Å—Ç–æ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –±–æ—Ç–∞ */
            -webkit-tap-highlight-color: transparent;
        }

        /* HEADER (Glassmorphism) */
        .app-bar {
            position: sticky; top: 0; z-index: 100;
            background: rgba(248, 253, 255, 0.9);
            backdrop-filter: blur(12px);
            padding: 12px 20px;
            display: flex; align-items: center; justify-content: space-between;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            transition: var(--anim);
        }
        .brand {
            font-size: 22px; font-weight: 700; color: var(--primary);
            display: flex; align-items: center; gap: 8px; cursor: pointer;
        }

        /* BUTTONS */
        .btn-icon {
            width: 44px; height: 44px; border-radius: 50%;
            border: none; background: transparent;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.2s; position: relative;
        }
        .btn-icon:hover { background: rgba(0,99,155,0.08); }
        .badge {
            position: absolute; top: 8px; right: 8px;
            width: 10px; height: 10px; background: #b3261e;
            border-radius: 50%; border: 2px solid #fff;
        }

        .btn-filled {
            background: var(--primary); color: var(--on-primary);
            height: 40px; padding: 0 24px; border-radius: 20px;
            border: none; font-weight: 500; cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,99,155,0.2);
            transition: 0.2s; display: flex; align-items: center; gap: 8px; justify-content: center;
        }
        .btn-filled:active { transform: scale(0.96); }

        /* CATEGORIES (Scroll) */
        .cat-scroll {
            display: flex; gap: 8px; overflow-x: auto;
            padding: 16px 20px; scrollbar-width: none;
        }
        .cat-scroll::-webkit-scrollbar { display: none; }
        .chip {
            padding: 8px 20px; border-radius: 12px;
            background: #fff; border: 1px solid #e1e3e5;
            white-space: nowrap; cursor: pointer;
            font-weight: 500; color: #444; transition: 0.2s;
        }
        .chip.active {
            background: var(--container); color: #001d32;
            border-color: transparent; font-weight: 700;
        }

        /* GRID & CARDS */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
            gap: 16px; padding: 0 20px;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; } }

        .card {
            background: #fff; border-radius: 16px;
            overflow: hidden; border: 1px solid #f0f4f8;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            transition: var(--anim); position: relative;
        }
        .card:hover { transform: translateY(-4px); box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
        
        .card-img {
            height: 150px; width: 100%; object-fit: cover;
            background: #f0f0f0;
        }
        .card-body { padding: 12px; }
        .card-title { font-weight: 600; font-size: 15px; margin-bottom: 4px; line-height: 1.3; }
        .card-seller { font-size: 12px; color: #666; margin-bottom: 8px; display: flex; align-items: center; gap: 4px; }
        .card-price { font-size: 18px; font-weight: 700; color: var(--primary); }

        /* FAB & AI CHAT */
        .fab {
            position: fixed; bottom: 30px; right: 20px;
            width: 64px; height: 64px; border-radius: 20px;
            background: linear-gradient(135deg, #6750A4, #9E79DB);
            color: white; border: none;
            box-shadow: 0 8px 20px rgba(103, 80, 164, 0.3);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            z-index: 200; transition: 0.3s;
        }
        .fab:hover { transform: scale(1.1) rotate(5deg); }

        .ai-modal {
            position: fixed; bottom: 100px; right: 20px;
            width: 340px; height: 450px;
            background: #fff; border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 199; display: flex; flex-direction: column;
            overflow: hidden; animation: slideUp 0.3s cubic-bezier(0.2, 0, 0, 1);
            border: 1px solid rgba(0,0,0,0.05);
        }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .chat-area { flex: 1; padding: 16px; overflow-y: auto; background: #fdfbff; display: flex; flex-direction: column; gap: 8px; }
        .msg { padding: 10px 14px; border-radius: 16px; font-size: 14px; max-width: 85%; }
        .msg.bot { background: #f0f0f0; align-self: flex-start; border-bottom-left-radius: 4px; }
        .msg.user { background: #6750A4; color: white; align-self: flex-end; border-bottom-right-radius: 4px; }

        /* UTILS */
        .hidden { display: none !important; }
        .toast {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
            background: #322f35; color: #fff; padding: 12px 24px;
            border-radius: 50px; font-size: 14px; z-index: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            animation: fadeIn 0.3s;
        }
        .search-wrap { padding: 0 20px; margin-top: 10px; }
        .search-input {
            width: 100%; height: 50px; border-radius: 25px;
            border: 1px solid transparent; background: #eff3f6;
            padding: 0 20px; font-size: 16px; outline: none;
            transition: 0.2s;
        }
        .search-input:focus { background: #fff; border-color: var(--primary); box-shadow: 0 0 0 2px rgba(0,99,155,0.1); }
    </style>
</head>
<body>
    
    <div id="root"></div>

    <script>
        /** YAKUTIA MARKET V7 - FINAL STABLE */
        
        // --- 1. DATA LAYER (–ë–æ–≥–∞—Ç–∞—è –±–∞–∑–∞) ---
        const DB = {
            products: [
                // –ú—è—Å–æ
                { id: 1, cat: 'meat', price: 850, img: 'https://placehold.co/400x300/ffcccb/a00?text=Sausage', title: {ru:'–ö–æ–ª–±–∞—Å–∞ –Ø–∫—É—Ç—Å–∫–∞—è', en:'Yakut Sausage', sah:'–°–∞—Ö–∞ –ö–æ–ª–±–∞—Å–∞'} },
                { id: 2, cat: 'meat', price: 1200, img: 'https://placehold.co/400x300/800000/fff?text=Olenina', title: {ru:'–û–ª–µ–Ω–∏–Ω–∞ –í—ã—Ä–µ–∑–∫–∞', en:'Venison Premium', sah:'–¢–∞–±–∞ –≠—Ç—ç'} },
                { id: 3, cat: 'meat', price: 3500, img: 'https://placehold.co/400x300/5c0000/fff?text=Horse+Meat', title: {ru:'–ñ–µ—Ä–µ–±—è—Ç–∏–Ω–∞ (–û–π–æ–≥–æ—Å)', en:'Horse Meat', sah:'–£–±–∞h–∞ –≠—Ç—ç'} },
                { id: 4, cat: 'meat', price: 450, img: 'https://placehold.co/400x300/ffcccb/a00?text=Pelmeni', title: {ru:'–ü–µ–ª—å–º–µ–Ω–∏ –î–æ–º–∞—à–Ω–∏–µ', en:'Dumplings', sah:'–ü–µ–ª—å–º–µ–Ω–Ω—ç—Ä'} },
                // –†—ã–±–∞
                { id: 5, cat: 'fish', price: 950, img: 'https://placehold.co/400x300/e0f7fa/006064?text=Chir', title: {ru:'–ß–∏—Ä –ü–æ–¥–ª–µ–¥–Ω—ã–π', en:'Fresh Chir', sah:'–ß—ã—ã—Ä'} },
                { id: 6, cat: 'fish', price: 1500, img: 'https://placehold.co/400x300/b2ebf2/006064?text=Stroganina', title: {ru:'–°—Ç—Ä–æ–≥–∞–Ω–∏–Ω–∞ –ù–∞–±–æ—Ä', en:'Stroganina Set', sah:'–¢–æ“• –ë–∞–ª—ã–∫'} },
                { id: 7, cat: 'fish', price: 800, img: 'https://placehold.co/400x300/e0f7fa/006064?text=Karas', title: {ru:'–ö–∞—Ä–∞—Å—å –ö–æ–±—è–π—Å–∫–∏–π', en:'Karas Fish', sah:'–°–æ–±–æ'} },
                // –ú–æ–ª–æ–∫–æ
                { id: 8, cat: 'milk', price: 120, img: 'https://placehold.co/400x300/fff9c4/fbc02d?text=Kefir', title: {ru:'–ö–µ—Ñ–∏—Ä –¢—É–π–º–∞–∞–¥–∞', en:'Kefir', sah:'–ö–µ—Ñ–∏—Ä'} },
                { id: 9, cat: 'milk', price: 350, img: 'https://placehold.co/400x300/fff9c4/fbc02d?text=Cream', title: {ru:'–°–ª–∏–≤–∫–∏ 35%', en:'Heavy Cream', sah:'–°—É–æ–≥—ç–π'} },
                { id: 10, cat: 'milk', price: 400, img: 'https://placehold.co/400x300/fff59d/fbc02d?text=Kuerchekh', title: {ru:'–ö–µ—Ä—á—ç—Ö (–î–µ—Å–µ—Ä—Ç)', en:'Kuerchekh', sah:'–ö“Ø”©—Ä—á—ç—Ö'} },
                // –Ø–≥–æ–¥—ã
                { id: 11, cat: 'berry', price: 3000, img: 'https://placehold.co/400x300/f8bbd0/880e4f?text=Cowberry', title: {ru:'–ë—Ä—É—Å–Ω–∏–∫–∞ (–í–µ–¥—Ä–æ)', en:'Cowberry Bucket', sah:'–£–æ–ª–∞'} },
                { id: 12, cat: 'berry', price: 4500, img: 'https://placehold.co/400x300/e1bee7/4a148c?text=Blueberry', title: {ru:'–ì–æ–ª—É–±–∏–∫–∞', en:'Blueberry', sah:'–ù—å—É—Ä–≥—Éh—É–Ω'} },
                // –°—É–≤–µ–Ω–∏—Ä—ã
                { id: 13, cat: 'souvenir', price: 5000, img: 'https://placehold.co/400x300/d7ccc8/5d4037?text=Khomus', title: {ru:'–•–æ–º—É—Å –ü—Ä–æ—Ñ.', en:'Khomus', sah:'–•–æ–º—É—Å'} },
                { id: 14, cat: 'souvenir', price: 1500, img: 'https://placehold.co/400x300/d7ccc8/5d4037?text=Mammoth', title: {ru:'–ë—Ä–µ–ª–æ–∫ –ú–∞–º–æ–Ω—Ç', en:'Mammoth Key', sah:'–ú–∞–º–æ–Ω—Ç'} },
            ]
        };

        // --- 2. I18N DICTIONARY (–ü–µ—Ä–µ–≤–æ–¥—ã) ---
        const T = {
            ru: { search: '–ù–∞–π—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç—ã...', all: '–í—Å–µ', meat: '–ú—è—Å–æ', fish: '–†—ã–±–∞', milk: '–ú–æ–ª–æ–∫–æ', berry: '–Ø–≥–æ–¥—ã', souvenir: '–°—É–≤–µ–Ω–∏—Ä—ã', add: '–í –∫–æ—Ä–∑–∏–Ω—É', cart: '–ö–æ—Ä–∑–∏–Ω–∞', profile: '–ü—Ä–æ—Ñ–∏–ª—å', login: '–í–æ–π—Ç–∏' },
            en: { search: 'Search products...', all: 'All', meat: 'Meat', fish: 'Fish', milk: 'Dairy', berry: 'Berries', souvenir: 'Gifts', add: 'Add to Cart', cart: 'Cart', profile: 'Profile', login: 'Login' },
            sah: { search: '–ê—Å –∫”©—Ä–¥”©”©“ª“Ø–Ω...', all: '–ë–∞—Ä—ã—Ç–∞', meat: '–≠—Ç', fish: '–ë–∞–ª—ã–∫', milk: '“Æ“Ø—Ç', berry: '–û—Ç–æ–Ω', souvenir: '–ë—ç–ª—ç—Ö', add: '–≠–±—ç–Ω', cart: '–ö–æ—Ä–∑–∏–Ω–∞', profile: '–ö–∞–±–∏–Ω–µ—Ç', login: '–ö–∏–∏—Ä' }
        };

        // --- 3. STATE MANAGEMENT ---
        const state = {
            lang: localStorage.getItem('lang') || 'ru',
            page: 'home',
            cat: 'all',
            search: '',
            cart: JSON.parse(localStorage.getItem('cart')) || [],
            user: JSON.parse(localStorage.getItem('user')) || null,
            aiOpen: false,
            msgs: [{ text: 'üëã –ü—Ä–∏–≤–µ—Ç! –Ø AI-–ø–æ–º–æ—â–Ω–∏–∫. –°–ø—Ä–æ—Å–∏ –ø—Ä–æ —Ä–µ—Ü–µ–ø—Ç –∏–ª–∏ –¥–æ—Å—Ç–∞–≤–∫—É.', sender: 'bot' }]
        };

        const update = () => {
            localStorage.setItem('cart', JSON.stringify(state.cart));
            localStorage.setItem('user', JSON.stringify(state.user));
            localStorage.setItem('lang', state.lang);
            render();
        };

        // --- 4. COMPONENTS ---
        const Icon = (name) => `<span class="material-symbols-rounded" style="font-size:24px">${name}</span>`;

        function Header() {
            const t = T[state.lang];
            return `
                <div class="app-bar">
                    <div class="brand" onclick="setPage('home')">
                        <span class="material-symbols-rounded" style="color:#00639b">storefront</span>
                        YakutiaMarket
                    </div>
                    <div style="display:flex; gap:8px">
                        <button class="btn-icon" style="font-size:14px; font-weight:bold" onclick="toggleLang()">
                            ${state.lang.toUpperCase()}
                        </button>
                        <button class="btn-icon" onclick="setPage('profile')">${Icon('person')}</button>
                        <button class="btn-icon" onclick="setPage('cart')">
                            ${Icon('shopping_bag')}
                            ${state.cart.length ? `<div class="badge"></div>` : ''}
                        </button>
                    </div>
                </div>
            `;
        }

        function Home() {
            const t = T[state.lang];
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
            let items = DB.products.filter(p => {
                const matchCat = state.cat === 'all' || p.cat === state.cat;
                const matchSearch = p.title[state.lang].toLowerCase().includes(state.search.toLowerCase());
                return matchCat && matchSearch;
            });

            return `
                <div class="search-wrap">
                    <input class="search-input" placeholder="${t.search}" oninput="setSearch(this.value)" value="${state.search}">
                </div>
                
                <div class="cat-scroll">
                    ${['all','meat','fish','milk','berry','souvenir'].map(c => `
                        <button class="chip ${state.cat === c ? 'active' : ''}" onclick="setCat('${c}')">
                            ${t[c]}
                        </button>
                    `).join('')}
                </div>

                <div class="grid">
                    ${items.map(p => `
                        <div class="card">
                            <img src="${p.img}" class="card-img" loading="lazy">
                            <div class="card-body">
                                <div class="card-title">${p.title[state.lang]}</div>
                                <div class="card-seller">${Icon('verified')} –¢–î –Ø–∫—É—Ç–∏—è</div>
                                <div class="card-price">${p.price} ‚ÇΩ</div>
                                <button class="btn-filled" style="width:100%; margin-top:8px" onclick="addToCart(${p.id})">
                                    ${t.add}
                                </button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function Cart() {
            const t = T[state.lang];
            const total = state.cart.reduce((sum, item) => sum + item.price * item.qty, 0);
            return `
                <div style="padding:20px; max-width:600px; margin:0 auto">
                    <h1>${t.cart} (${state.cart.length})</h1>
                    ${state.cart.map(i => `
                        <div style="display:flex; gap:12px; margin-bottom:12px; background:#fff; padding:12px; border-radius:12px; align-items:center">
                            <img src="${i.img}" style="width:60px; height:60px; border-radius:8px; object-fit:cover">
                            <div style="flex:1">
                                <div style="font-weight:bold">${i.title[state.lang]}</div>
                                <div>${i.price} ‚ÇΩ</div>
                            </div>
                            <div style="background:#f0f4f8; padding:4px 12px; border-radius:20px; font-weight:bold">
                                x${i.qty}
                            </div>
                            <button class="btn-icon" onclick="removeFromCart(${i.id})" style="color:red">${Icon('delete')}</button>
                        </div>
                    `).join('')}
                    
                    ${state.cart.length ? `
                        <div style="margin-top:20px; text-align:right; font-size:20px; font-weight:bold">
                            –ò—Ç–æ–≥–æ: ${total} ‚ÇΩ
                        </div>
                        <button class="btn-filled" style="width:100%; margin-top:16px; height:50px; font-size:18px" onclick="checkout()">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                        </button>
                    ` : '<div style="text-align:center; color:#999; margin-top:40px">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ üõí</div>'}
                </div>
            `;
        }

        function Profile() {
            const t = T[state.lang];
            if (!state.user) {
                return `
                    <div style="padding:40px 20px; text-align:center; max-width:400px; margin:0 auto">
                        <h1>${t.login}</h1>
                        <div style="display:grid; gap:12px; margin-top:24px">
                            <button class="btn-filled" onclick="login('buyer')">üë§ –Ø –ü–æ–∫—É–ø–∞—Ç–µ–ª—å</button>
                            <button class="btn-filled" style="background:#444" onclick="login('seller')">üè™ –Ø –ü—Ä–æ–¥–∞–≤–µ—Ü</button>
                        </div>
                    </div>
                `;
            }
            return `
                <div style="padding:20px; max-width:600px; margin:0 auto">
                    <div style="display:flex; align-items:center; gap:16px; margin-bottom:30px">
                        <div style="width:80px; height:80px; border-radius:50%; background:#00639b; color:#fff; display:flex; align-items:center; justify-content:center; font-size:32px">
                            ${state.user.name[0]}
                        </div>
                        <div>
                            <h2 style="margin:0">${state.user.name}</h2>
                            <div style="color:#666">${state.user.role === 'seller' ? '–ü—Ä–æ–¥–∞–≤–µ—Ü' : '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å'}</div>
                        </div>
                    </div>
                    
                    ${state.user.role === 'seller' ? `
                        <div style="background:#e3f2fd; padding:20px; border-radius:16px; margin-bottom:20px; cursor:pointer" onclick="showToast('–¢–æ–≤–∞—Ä —Å–æ–∑–¥–∞–Ω! (–î–µ–º–æ)')">
                            <h3 style="margin:0 0 10px 0; color:#00639b">–ü–∞–Ω–µ–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞</h3>
                            <button class="btn-filled" style="background:#00639b">${Icon('add')} –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                        </div>
                    ` : ''}

                    <div style="display:grid; gap:8px">
                         <div style="padding:16px; background:#fff; border-radius:12px">${Icon('receipt_long')} –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</div>
                         <div style="padding:16px; background:#fff; border-radius:12px; color:red; cursor:pointer" onclick="logout()">${Icon('logout')} –í—ã–π—Ç–∏</div>
                    </div>
                </div>
            `;
        }

        function AIChat() {
            if (!state.aiOpen) return '';
            return `
                <div class="ai-modal">
                    <div style="padding:16px; background:#6750A4; color:#fff; font-weight:bold; display:flex; justify-content:space-between">
                        <span>ü§ñ AI –ü–æ–º–æ—â–Ω–∏–∫</span>
                        <span style="cursor:pointer" onclick="toggleAI()">${Icon('close')}</span>
                    </div>
                    <div class="chat-area" id="chatbox">
                        ${state.msgs.map(m => `<div class="msg ${m.sender}">${m.text}</div>`).join('')}
                    </div>
                    <div style="padding:10px; border-top:1px solid #eee; display:flex; gap:8px">
                        <input id="aiInput" style="flex:1; padding:10px; border-radius:20px; border:1px solid #ddd; outline:none" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ '—Ä–µ—Ü–µ–ø—Ç'...">
                        <button class="btn-icon" onclick="sendAI()">${Icon('send')}</button>
                    </div>
                </div>
            `;
        }

        // --- 5. LOGIC & ACTIONS ---
        window.setPage = (p) => { state.page = p; update(); };
        window.setCat = (c) => { state.cat = c; update(); };
        window.setSearch = (v) => { state.search = v; update(); };
        window.toggleLang = () => { 
            const langs = ['ru', 'en', 'sah'];
            const idx = langs.indexOf(state.lang);
            state.lang = langs[(idx + 1) % 3];
            update();
        };

        window.addToCart = (id) => {
            const p = DB.products.find(x => x.id === id);
            const exist = state.cart.find(x => x.id === id);
            if (exist) exist.qty++; else state.cart.push({ ...p, qty: 1 });
            showToast(`‚úÖ ${p.title[state.lang]} –¥–æ–±–∞–≤–ª–µ–Ω`);
            update();
        };

        window.removeFromCart = (id) => {
            state.cart = state.cart.filter(x => x.id !== id);
            update();
        };

        window.login = (role) => {
            state.user = { name: role === 'seller' ? '–ê–π–∞–∞–ª –§–µ—Ä–º–µ—Ä' : '–¢—É–π–∞–∞—Ä–∞', role };
            state.page = 'profile';
            update();
        };
        window.logout = () => { state.user = null; state.page = 'home'; update(); };
        window.checkout = () => { state.cart = []; alert('–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –°–ø–∞—Å–∏–±–æ.'); update(); };

        // AI Logic
        window.toggleAI = () => { state.aiOpen = !state.aiOpen; update(); };
        window.sendAI = () => {
            const inp = document.getElementById('aiInput');
            const txt = inp.value.trim().toLowerCase();
            if (!txt) return;
            
            state.msgs.push({ text: inp.value, sender: 'user' });
            inp.value = ''; update();

            let reply = "–Ø –ø–æ–∫–∞ —É—á—É—Å—å. –°–ø—Ä–æ—Å–∏—Ç–µ –ø—Ä–æ —Ä–µ—Ü–µ–ø—Ç, –¥–æ—Å—Ç–∞–≤–∫—É –∏–ª–∏ –æ–ª–µ–Ω–∏–Ω—É.";
            if (txt.includes('—Ä–µ—Ü–µ–ø—Ç')) reply = "üç≥ –†–µ—Ü–µ–ø—Ç —Å—Ç—Ä–æ–≥–∞–Ω–∏–Ω—ã: –≤–æ–∑—å–º–∏—Ç–µ —Å–≤–µ–∂–∏–π —á–∏—Ä, –∑–∞–º–æ—Ä–æ–∑—å—Ç–µ, –Ω–∞—Å—Ç—Ä–æ–≥–∞–π—Ç–µ —Ç–æ–Ω–∫–æ. –ü–æ–¥–∞–≤–∞–π—Ç–µ —Å —Å–æ–ª—å—é –∏ –ø–µ—Ä—Ü–µ–º.";
            if (txt.includes('–æ–ª–µ–Ω–∏–Ω')) reply = "ü•© –û–ª–µ–Ω–∏–Ω–∞ ‚Äî –¥–∏–µ—Ç–∏—á–µ—Å–∫–æ–µ –º—è—Å–æ. –†–µ–∫–æ–º–µ–Ω–¥—É—é —Ç—É—à–∏—Ç—å —Å –±—Ä—É—Å–Ω–∏–∫–æ–π 40 –º–∏–Ω—É—Ç.";
            if (txt.includes('–¥–æ—Å—Ç–∞–≤–∫')) reply = "üöö –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –Ø–∫—É—Ç—Å–∫—É –∑–∞ 1 —á–∞—Å. –ü—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 2000‚ÇΩ ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ!";

            setTimeout(() => {
                state.msgs.push({ text: reply, sender: 'bot' });
                update();
                const box = document.getElementById('chatbox');
                if(box) box.scrollTop = box.scrollHeight;
            }, 600);
        };

        window.showToast = (msg) => {
            const el = document.createElement('div');
            el.className = 'toast'; el.innerText = msg;
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 2000);
        };

        // --- 6. RENDER LOOP ---
        function render() {
            const root = document.getElementById('root');
            let content = '';
            if (state.page === 'home') content = Home();
            else if (state.page === 'cart') content = Cart();
            else if (state.page === 'profile') content = Profile();

            root.innerHTML = `
                ${Header()}
                <div style="max-width:1200px; margin:0 auto">${content}</div>
                <button class="fab" onclick="toggleAI()">${Icon('smart_toy')}</button>
                ${AIChat()}
            `;
            
            // Auto scroll chat
            if(state.aiOpen) {
                 const box = document.getElementById('chatbox');
                 if(box) box.scrollTop = box.scrollHeight;
            }
        }

        // Init
        render();

    </script>
</body>
</html>
